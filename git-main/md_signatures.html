<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.10.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>infix: FFI Signature Format Specification v1.0</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="version_selector_handler.js"></script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectalign">
                <div id="projectname">infix
                  <span id="projectnumber"/>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part --><!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">FFI Signature Format Specification v1.0</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md157"></a> </p>
<h2><a class="anchor" id="autotoc_md158"></a>
Part 1: Introduction</h2>
<h3><a class="anchor" id="autotoc_md159"></a>
1.1 The Challenge of Interoperability</h3>
<p>The core challenge of any FFI is establishing a precise, unambiguous contract between the caller and the callee. Both sides must agree on the exact size, alignment, and representation of every piece of data.</p>
<h3><a class="anchor" id="autotoc_md160"></a>
1.2 The Limitations of C Declarations</h3>
<p><a class="el" href="classC.html">C</a>'s declaration syntax, while powerful, is notoriously difficult for both humans and machines to parse, often hiding the true memory layout of data. <a class="el" href="classA.html">A</a> declaration like <code>void (*(*f[])())()</code> is a testament to this complexity.</p>
<h3><a class="anchor" id="autotoc_md161"></a>
1.3 Our Solution: A Human-First Signature System</h3>
<p>This document specifies a string-based representation of <a class="el" href="classC.html">C</a> types and function signatures, built on three core principles:</p>
<ol type="1">
<li><b>Human-Readability First:</b> The syntax is intuitive and prioritizes clarity.</li>
<li><b>Unambiguous and Consistent:</b> The grammar is designed to be parsed linearly without ambiguity.</li>
<li><b>Developer-Centric Type System:</b> It provides two tiers of types: abstract C-style keywords for portability, and explicit fixed-width keywords for precise layout control.</li>
</ol>
<h3><a class="anchor" id="autotoc_md162"></a>
1.4 A Stateless, Composable Core</h3>
<p>The core FFI library is <b>stateless</b> and does not maintain a global type registry. This empowers the user to manage named types in their own application space (e.g., in a hash map). The user is responsible for resolving these named types into a final, fully-qualified signature string before passing it to the stateless FFI core.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md163"></a>
Part 2: The Type System Reference</h1>
<p>The signature system is composed of primitive types, type constructors, and composite data structures.</p>
<h2><a class="anchor" id="autotoc_md164"></a>
2.1 Tier 1: Abstract C Types</h2>
<p>These keywords represent standard <a class="el" href="classC.html">C</a> types whose size can vary by platform.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Signature   </th><th class="markdownTableHeadLeft">Size   </th><th class="markdownTableHeadLeft">C/C++ Equivalent   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>void</code>   </td><td class="markdownTableBodyLeft">N/A   </td><td class="markdownTableBodyLeft"><code>void</code>   </td><td class="markdownTableBodyLeft">Represents the absence of a value.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>char</code>   </td><td class="markdownTableBodyLeft">8 bits   </td><td class="markdownTableBodyLeft"><code>signed char</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> signed 8-bit integer.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>uchar</code>   </td><td class="markdownTableBodyLeft">8 bits   </td><td class="markdownTableBodyLeft"><code>unsigned char</code>   </td><td class="markdownTableBodyLeft">An unsigned 8-bit integer.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>short</code>   </td><td class="markdownTableBodyLeft">16 bits   </td><td class="markdownTableBodyLeft"><code>short</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> signed integer of at least 16 bits.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>ushort</code>   </td><td class="markdownTableBodyLeft">16 bits   </td><td class="markdownTableBodyLeft"><code>unsigned short</code>   </td><td class="markdownTableBodyLeft">An unsigned integer of at least 16 bits.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>int</code>   </td><td class="markdownTableBodyLeft">32 bits   </td><td class="markdownTableBodyLeft"><code>int</code>   </td><td class="markdownTableBodyLeft">The platform's native signed integer, usually 32 bits.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>uint</code>   </td><td class="markdownTableBodyLeft">32 bits   </td><td class="markdownTableBodyLeft"><code>unsigned int</code>   </td><td class="markdownTableBodyLeft">The platform's native unsigned integer.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>long</code>   </td><td class="markdownTableBodyLeft"><b>32 or 64 bits</b>   </td><td class="markdownTableBodyLeft"><code>long</code>   </td><td class="markdownTableBodyLeft"><b>The key abstract integer.</b> 32 bits on 64-bit Windows, 64 bits on Linux.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>ulong</code>   </td><td class="markdownTableBodyLeft"><b>32 or 64 bits</b>   </td><td class="markdownTableBodyLeft"><code>unsigned long</code>   </td><td class="markdownTableBodyLeft">The unsigned version of <code>long</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>longlong</code>   </td><td class="markdownTableBodyLeft">64 bits   </td><td class="markdownTableBodyLeft"><code>long long</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> signed integer of at least 64 bits.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>ulonglong</code>   </td><td class="markdownTableBodyLeft">64 bits   </td><td class="markdownTableBodyLeft"><code>unsigned long long</code>   </td><td class="markdownTableBodyLeft">An unsigned integer of at least 64 bits.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>float</code>   </td><td class="markdownTableBodyLeft">32 bits   </td><td class="markdownTableBodyLeft"><code>float</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> 32-bit single-precision floating-point number.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>double</code>   </td><td class="markdownTableBodyLeft">64 bits   </td><td class="markdownTableBodyLeft"><code>double</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> 64-bit double-precision floating-point number.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>long double</code>   </td><td class="markdownTableBodyLeft"><b>Varies</b>   </td><td class="markdownTableBodyLeft"><code>long double</code>   </td><td class="markdownTableBodyLeft">80-bit (x86), 128-bit (AArch64), or 64-bit (MSVC) float. Use with caution.   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md165"></a>
2.2 Tier 2: Explicit Fixed-Width Types</h2>
<p>These keywords are used when the exact size of a type is known and required.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Signature Keyword   </th><th class="markdownTableHeadLeft">Common <a class="el" href="classC.html">C</a> Equivalent   </th><th class="markdownTableHeadLeft">Size   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>int8</code>, <code>uint8</code>   </td><td class="markdownTableBodyLeft"><code>int8_t</code>, <code>uint8_t</code>   </td><td class="markdownTableBodyLeft">8 bits   </td><td class="markdownTableBodyLeft">Explicitly-sized 8-bit signed/unsigned integers.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>int16</code>, <code>uint16</code>   </td><td class="markdownTableBodyLeft"><code>int16_t</code>, <code>uint16_t</code>   </td><td class="markdownTableBodyLeft">16 bits   </td><td class="markdownTableBodyLeft">Explicitly-sized 16-bit signed/unsigned integers.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>int32</code>, <code>uint32</code>   </td><td class="markdownTableBodyLeft"><code>int32_t</code>, <code>uint32_t</code>   </td><td class="markdownTableBodyLeft">32 bits   </td><td class="markdownTableBodyLeft">Explicitly-sized 32-bit signed/unsigned integers.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>int64</code>, <code>uint64</code>   </td><td class="markdownTableBodyLeft"><code>int64_t</code>, <code>uint64_t</code>   </td><td class="markdownTableBodyLeft">64 bits   </td><td class="markdownTableBodyLeft">Explicitly-sized 64-bit signed/unsigned integers.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>int128</code>, <code>uint128</code>   </td><td class="markdownTableBodyLeft"><code>__int128_t</code>   </td><td class="markdownTableBodyLeft">128 bits   </td><td class="markdownTableBodyLeft">128-bit integers, a common compiler extension.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>float32</code>   </td><td class="markdownTableBodyLeft"><code>float</code>   </td><td class="markdownTableBodyLeft">32 bits   </td><td class="markdownTableBodyLeft">An explicit alias for a 32-bit float.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>float64</code>   </td><td class="markdownTableBodyLeft"><code>double</code>   </td><td class="markdownTableBodyLeft">64 bits   </td><td class="markdownTableBodyLeft">An explicit alias for a 64-bit float.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>float80</code>   </td><td class="markdownTableBodyLeft"><code>long double</code> (x86)   </td><td class="markdownTableBodyLeft">80 bits   </td><td class="markdownTableBodyLeft">An 80-bit extended-precision float.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>float128</code>   </td><td class="markdownTableBodyLeft"><code>long double</code> (PPC/AArch64)   </td><td class="markdownTableBodyLeft">128 bits   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> 128-bit quadruple-precision float.   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md166"></a>
2.3 Advanced Numeric and Vector Types</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Name   </th><th class="markdownTableHeadLeft">Signature Syntax   </th><th class="markdownTableHeadLeft"><a class="el" href="classC.html">C</a> Equivalent   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Complex <a class="el" href="unionNumber.html" title="A simple union of an integer and a float.">Number</a></b>   </td><td class="markdownTableBodyLeft"><code>c[&lt;type&gt;]</code>   </td><td class="markdownTableBodyLeft"><code>float _Complex</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> complex number constructed from a floating-point <code>&lt;type&gt;</code>. Layout is <code>[2:&lt;type&gt;]</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>SIMD Vector</b>   </td><td class="markdownTableBodyLeft"><code>v[&lt;N&gt;:&lt;type&gt;]</code>   </td><td class="markdownTableBodyLeft"><code>__m128d</code>, etc.   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> SIMD vector with <code>N</code> elements of a primitive <code>&lt;type&gt;</code>.   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md167"></a>
2.4 Type Constructors and Composite Structures</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Name   </th><th class="markdownTableHeadLeft">Syntax   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Pointer</b>   </td><td class="markdownTableBodyLeft"><code>*&lt;type&gt;</code>   </td><td class="markdownTableBodyLeft">The asterisk <code>*</code> is the universal prefix for a pointer to any other valid type. <code>*void</code> is the generic pointer.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Array</b>   </td><td class="markdownTableBodyLeft"><code>[&lt;size&gt;:&lt;type&gt;]</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> fixed-size array.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Struct</b>   </td><td class="markdownTableBodyLeft"><code>struct&lt;Name&gt;{...}</code> <br  />
 <code>{...}</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> <a class="el" href="classC.html">C</a> <code>struct</code>, defined by its <code>{...}</code> body.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Packed Struct</b>   </td><td class="markdownTableBodyLeft"><code>!{...}</code> <br  />
 <code>!N:{...}</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> packed <code>struct</code>. <code>!{...}</code> defaults to 1-byte alignment. <code>!N:{...}</code> specifies an explicit N-byte alignment.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Union</b>   </td><td class="markdownTableBodyLeft"><code>union&lt;Name&gt;&lt;...&gt;</code> <br  />
 <code>&lt;...&gt;</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> <a class="el" href="classC.html">C</a> <code>union</code>, defined by its <code>&lt;...&gt;</code> body.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Enum</b>   </td><td class="markdownTableBodyLeft"><code>e&lt;Name&gt;:&lt;type&gt;</code> <br  />
 <code>e:&lt;type&gt;</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> <a class="el" href="classC.html">C</a> <code>enum</code>. This is a semantic alias for an underlying integer <code>&lt;type&gt;</code>, which is <b>required</b>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Function Signature</b>   </td><td class="markdownTableBodyLeft"><code>(&lt;arg_types&gt;) -&gt; &lt;return_type&gt;</code>   </td><td class="markdownTableBodyLeft">Defines the type of a function. Arguments may be named (<code>(name:type)</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Variadic Signature</b>   </td><td class="markdownTableBodyLeft"><code>(&lt;fixed_args&gt;; &lt;variadic_args&gt;) -&gt; &lt;return_type&gt;</code>   </td><td class="markdownTableBodyLeft">Defines a variadic function. <a class="el" href="classA.html">A</a> semicolon <code>;</code> separates the fixed arguments from the variadic ones.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Function Pointer</b>   </td><td class="markdownTableBodyLeft"><code>*((&lt;arg_types&gt;) -&gt; &lt;return_type&gt;)</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> pointer to a function.   </td></tr>
</table>
<hr  />
<h2><a class="anchor" id="autotoc_md168"></a>
Part 3: Examples, Best Practices, and Usage</h2>
<h3><a class="anchor" id="autotoc_md169"></a>
3.1 Syntax Showcase</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">FFI Signature   </th><th class="markdownTableHeadLeft">Breakdown    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>int</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> standard <a class="el" href="classC.html">C</a> signed integer.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>*char</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> pointer to a <a class="el" href="classC.html">C</a> <code>signed char</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>**void</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> pointer to a generic <code>void</code> pointer.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>[16:char]</code>   </td><td class="markdownTableBodyLeft">An array of 16 signed characters.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>*[16:char]</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> pointer to an array of 16 signed characters.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>{int, float}</code>   </td><td class="markdownTableBodyLeft">An anonymous struct containing an <code>int</code> followed by a <code>float</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>{id:uint64, score:double}</code>   </td><td class="markdownTableBodyLeft">An anonymous struct with two named fields.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>!{id:uint16, status:char}</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> packed struct (1-byte alignment). <code>status</code> will be at offset 2.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>!4:{a:char, b:longlong}</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> packed struct with 4-byte alignment. <code>b</code> will be padded to start at offset 4.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>&lt;int, float64&gt;</code>   </td><td class="markdownTableBodyLeft">An anonymous union that can hold either an <code>int</code> or a 64-bit <code>float64</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>() -&gt; void</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> function that takes no arguments and returns nothing.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>(*char, int) -&gt; int</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> function that takes a <code>*char</code> and an <code>int</code>, and returns an <code>int</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>(*char; int, double) -&gt; int</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> variadic call like <code>printf</code>. The semicolon <code>;</code> marks the start of the variadic part.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>*((int, int) -&gt; int)</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> pointer to a function that takes two <code>int</code>s and returns an <code>int</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>struct&lt;Ctx&gt;{ data:*void, callback:*( (int) -&gt; void ) }</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> struct with a function pointer field named <code>callback</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>c[float]</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> <a class="el" href="classC.html">C</a> <code>float _Complex</code> number.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>v[4:float]</code>   </td><td class="markdownTableBodyLeft"><a class="el" href="classA.html">A</a> 128-bit SIMD vector containing four 32-bit floats.   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md170"></a>
3.2 Architectural Pattern: Define and Use</h3>
<p>This example demonstrates the "define once, use by reference" pattern that the stateless FFI architecture enables. The user's application or binding is responsible for resolving named types into a complete, self-contained signature string before passing it to the <code>infix</code> core.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md171"></a>
Part 4: Technical Specification and Design Rationale</h1>
<h3><a class="anchor" id="autotoc_md172"></a>
4.1 Whitespace and Comments</h3>
<p>Insignificant whitespace (spaces, tabs, newlines) is permitted between any two tokens and should be ignored. Comments begin with a hash symbol (<code>#</code>) and continue to the end of the line.</p>
<h3><a class="anchor" id="autotoc_md173"></a>
4.2 EBNF Grammar</h3>
<p>This Extended Backus-Naur Form grammar formally defines the signature format.</p>
<div class="fragment"><div class="line">signature           ::= function_type | value_type</div>
<div class="line">value_type          ::= pointer_type | array_type | aggregate_type | enum_type | complex_type | vector_type | primitive_type | grouped_type</div>
<div class="line"> </div>
<div class="line">pointer_type        ::= &#39;*&#39; value_type</div>
<div class="line">array_type          ::= &#39;[&#39; Integer &#39;:&#39; value_type &#39;]&#39;</div>
<div class="line">grouped_type        ::= &#39;(&#39; value_type &#39;)&#39;</div>
<div class="line"> </div>
<div class="line">aggregate_type      ::= struct_type | union_type | packed_struct_type</div>
<div class="line">struct_type         ::= ( &#39;struct&#39; &#39;&lt;&#39; Identifier &#39;&gt;&#39; )? &#39;{&#39; member_list? &#39;}&#39;</div>
<div class="line">packed_struct_type  ::= &#39;!&#39; ( Integer &#39;:&#39; )? &#39;{&#39; member_list? &#39;}&#39;</div>
<div class="line">union_type          ::= ( &#39;union&#39; &#39;&lt;&#39; Identifier &#39;&gt;&#39; )? &#39;&lt;&#39; member_list? &#39;&gt;&#39;</div>
<div class="line">member_list         ::= member ( &#39;,&#39; member )*</div>
<div class="line">member              ::= ( Identifier &#39;:&#39; )? value_type</div>
<div class="line"> </div>
<div class="line">enum_type           ::= &#39;e&#39; ( &#39;&lt;&#39; Identifier &#39;&gt;&#39; )? &#39;:&#39; primitive_type</div>
<div class="line">complex_type        ::= &#39;c&#39; &#39;[&#39; value_type &#39;]&#39;</div>
<div class="line">vector_type         ::= &#39;v&#39; &#39;[&#39; Integer &#39;:&#39; value_type &#39;]&#39;</div>
<div class="line"> </div>
<div class="line">function_type       ::= &#39;(&#39; arg_list? &#39;)&#39; &#39;-&gt;&#39; value_type</div>
<div class="line">arg_list            ::= fixed_args ( &#39;;&#39; variadic_args )?</div>
<div class="line">fixed_args          ::= arg ( &#39;,&#39; arg )*</div>
<div class="line">variadic_args       ::= arg ( &#39;,&#39; arg )*</div>
<div class="line">arg                 ::= ( Identifier &#39;:&#39; )? value_type</div>
<div class="line"> </div>
<div class="line">primitive_type      ::= &#39;void&#39; | &#39;bool&#39; | &#39;char&#39; | &#39;uchar&#39; | &#39;short&#39; | &#39;ushort&#39; | &#39;int&#39; | &#39;uint&#39; | &#39;long&#39; | &#39;ulong&#39; | &#39;longlong&#39; | &#39;ulonglong&#39; | &#39;float&#39; | &#39;double&#39; | &#39;long_double&#39; | &#39;int8&#39; | &#39;uint8&#39; | &#39;int16&#39; | &#39;uint16&#39; | &#39;int32&#39; | &#39;uint32&#39; | &#39;int64&#39; | &#39;uint64&#39; | &#39;int128&#39; | &#39;uint128&#39; | &#39;float32&#39; | &#39;float64&#39; | &#39;float80&#39; | &#39;float128&#39;</div>
<div class="line"> </div>
<div class="line">Identifier          ::= [a-zA-Z_] [a-zA-Z0-9_]*</div>
<div class="line">Integer             ::= [0-9]+</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md174"></a>
4.3 Design Rationale: Why This Syntax?</h3>
<ol type="1">
<li><b>Readability over Brevity:</b> The two-tier type system (<code>int</code> vs. <code>int32</code>) directly maps to developer intent ("portability" vs. "specific layout").</li>
<li><b>Unambiguous Grammar:</b> Using a pure prefix for pointers (<code>*</code>) and clear delimiters for all other composites (<code>[]</code>, <code>{}</code>, <code>&lt;&gt;</code>) eliminates ambiguity and allows for simple, linear parsing.</li>
<li><b>Consistency:</b> The <code>c[...]</code> and <code>v[...]</code> syntax for complex and vector types creates a consistent "family" of specialized numeric constructors.</li>
</ol>
<h3><a class="anchor" id="autotoc_md175"></a>
4.4 Comparison with Other Systems</h3>
<ul>
<li><b>vs. Itanium C++ ABI:</b> Itanium is a "write-only" format designed for linkers. Our system is designed for humans to read and write.</li>
<li><b>vs. Python's <code>ctypes</code>:</b> <code>ctypes</code> uses a programmatic, object-oriented approach. Our format is a standalone, declarative string that can be used by <em>any</em> language.</li>
<li><b>vs. <code>dyncall</code>'s Signature Format:</b><ul>
<li><b>Philosophy:</b> <code>dyncall</code>'s format is a flat string of single characters (e.g., <code>iSl)d</code>), prioritizing brevity. Our system prioritizes human readability (<code>(int, ushort, longlong) -&gt; double</code>).</li>
<li><b>Expressiveness:</b> The <code>dyncall</code> signature can only describe primitive types. Our format treats complex data structures as first-class citizens. Our format answers, "What is the complete data contract for this function, including the shape of all its related data structures?" </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
