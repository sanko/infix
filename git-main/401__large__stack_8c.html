<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.10.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>infix: /home/runner/work/infix/infix/t/401_large_stack.c File Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="version_selector_handler.js"></script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectalign">
                <div id="projectname">infix
                  <span id="projectnumber"/>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part --><!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_75a01b229474ab4722425a88156bb54e.html">t</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">401_large_stack.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Tests FFI calls with a large number of arguments, forcing stack usage.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="double__tap_8h_source.html">common/double_tap.h</a>&quot;</code><br />
<code>#include &quot;types.h&quot;</code><br />
<code>#include &lt;<a class="el" href="infix_8h_source.html">infix/infix.h</a>&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1655e4adfda95660042d34619eb61845" id="r_a1655e4adfda95660042d34619eb61845"><td class="memItemLeft" align="right" valign="top"><a id="a1655e4adfda95660042d34619eb61845" name="a1655e4adfda95660042d34619eb61845"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DBLTAP_IMPLEMENTATION</b></td></tr>
<tr class="separator:a1655e4adfda95660042d34619eb61845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab319619963cedcd93714c5c6df0dee5d" id="r_ab319619963cedcd93714c5c6df0dee5d"><td class="memItemLeft" align="right" valign="top"><a id="ab319619963cedcd93714c5c6df0dee5d" name="ab319619963cedcd93714c5c6df0dee5d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_REG_DOUBLES</b>&#160;&#160;&#160;8</td></tr>
<tr class="separator:ab319619963cedcd93714c5c6df0dee5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aade27249ba136699f108174289e538fc" id="r_aade27249ba136699f108174289e538fc"><td class="memItemLeft" align="right" valign="top"><a id="aade27249ba136699f108174289e538fc" name="aade27249ba136699f108174289e538fc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ONE_STACK_DOUBLE</b>&#160;&#160;&#160;(MAX_REG_DOUBLES + 1)</td></tr>
<tr class="separator:aade27249ba136699f108174289e538fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c157e46e692e6b6b07f7e33e9f7e9ef" id="r_a8c157e46e692e6b6b07f7e33e9f7e9ef"><td class="memItemLeft" align="right" valign="top"><a id="a8c157e46e692e6b6b07f7e33e9f7e9ef" name="a8c157e46e692e6b6b07f7e33e9f7e9ef"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ARG</b>(N)&#160;&#160;&#160;c23_maybe_unused double arg##N</td></tr>
<tr class="separator:a8c157e46e692e6b6b07f7e33e9f7e9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad913dae1bd62e1aec29d8b557df6f21d" id="r_ad913dae1bd62e1aec29d8b557df6f21d"><td class="memItemLeft" align="right" valign="top"><a id="ad913dae1bd62e1aec29d8b557df6f21d" name="ad913dae1bd62e1aec29d8b557df6f21d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LIST10</b>(M,  p)&#160;&#160;&#160;M(p##0), M(p##1), M(p##2), M(p##3), M(p##4), M(p##5), M(p##6), M(p##7), M(p##8), M(p##9)</td></tr>
<tr class="separator:ad913dae1bd62e1aec29d8b557df6f21d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe34be58e85259442d89c13a804cedda" id="r_abe34be58e85259442d89c13a804cedda"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe34be58e85259442d89c13a804cedda">LIST100</a>(M,  p)</td></tr>
<tr class="separator:abe34be58e85259442d89c13a804cedda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac867de98a2635ed26a74d5dd3a5bd22e" id="r_ac867de98a2635ed26a74d5dd3a5bd22e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac867de98a2635ed26a74d5dd3a5bd22e">ARGS_0_TO_99</a></td></tr>
<tr class="separator:ac867de98a2635ed26a74d5dd3a5bd22e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda84b89ab2bfcd7dbac64ed7a7de26d" id="r_acda84b89ab2bfcd7dbac64ed7a7de26d"><td class="memItemLeft" align="right" valign="top"><a id="acda84b89ab2bfcd7dbac64ed7a7de26d" name="acda84b89ab2bfcd7dbac64ed7a7de26d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ARGS_100_TO_499</b>&#160;&#160;&#160;LIST100(ARG, 1), LIST100(ARG, 2), LIST100(ARG, 3), LIST100(ARG, 4)</td></tr>
<tr class="separator:acda84b89ab2bfcd7dbac64ed7a7de26d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af17c47557820689b297102a239ba009b" id="r_af17c47557820689b297102a239ba009b"><td class="memItemLeft" align="right" valign="top"><a id="af17c47557820689b297102a239ba009b" name="af17c47557820689b297102a239ba009b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ARGS_500_TO_519</b>&#160;&#160;&#160;LIST10(ARG, 50), LIST10(ARG, 51)</td></tr>
<tr class="separator:af17c47557820689b297102a239ba009b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b367d8dddbfbf9da05e92a2a53e9ebc" id="r_a5b367d8dddbfbf9da05e92a2a53e9ebc"><td class="memItemLeft" align="right" valign="top"><a id="a5b367d8dddbfbf9da05e92a2a53e9ebc" name="a5b367d8dddbfbf9da05e92a2a53e9ebc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NUM_LARGE_ARGS</b>&#160;&#160;&#160;520</td></tr>
<tr class="separator:a5b367d8dddbfbf9da05e92a2a53e9ebc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a64caa6314252677d0c90338cdf4c2381" id="r_a64caa6314252677d0c90338cdf4c2381"><td class="memItemLeft" align="right" valign="top"><a id="a64caa6314252677d0c90338cdf4c2381" name="a64caa6314252677d0c90338cdf4c2381"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>sum_max_reg_doubles</b> (double a1, double a2, double a3, double a4, double a5, double a6, double a7, double a8)</td></tr>
<tr class="memdesc:a64caa6314252677d0c90338cdf4c2381"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sums the maximum number of doubles that can fit in registers for the target ABI. <br /></td></tr>
<tr class="separator:a64caa6314252677d0c90338cdf4c2381"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b8eb95f56635f721ca7df36ba089536" id="r_a1b8eb95f56635f721ca7df36ba089536"><td class="memItemLeft" align="right" valign="top"><a id="a1b8eb95f56635f721ca7df36ba089536" name="a1b8eb95f56635f721ca7df36ba089536"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>sum_one_stack_double</b> (double a1, double a2, double a3, double a4, double a5, double a6, double a7, double a8, double a9)</td></tr>
<tr class="memdesc:a1b8eb95f56635f721ca7df36ba089536"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sums one more double than can fit in registers, forcing one onto the stack. <br /></td></tr>
<tr class="separator:a1b8eb95f56635f721ca7df36ba089536"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9b25f0d708a936741592612cc6abfa" id="r_a8d9b25f0d708a936741592612cc6abfa"><td class="memItemLeft" align="right" valign="top"><a id="a8d9b25f0d708a936741592612cc6abfa" name="a8d9b25f0d708a936741592612cc6abfa"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>large_stack_callee</b> (ARGS_0_TO_99, ARGS_100_TO_499, ARGS_500_TO_519)</td></tr>
<tr class="memdesc:a8d9b25f0d708a936741592612cc6abfa"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classA.html">A</a> function with 520 arguments to test massive stack frames. <br /></td></tr>
<tr class="separator:a8d9b25f0d708a936741592612cc6abfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba3852631c88f666e148008813c88979" id="r_aba3852631c88f666e148008813c88979"><td class="memItemLeft" align="right" valign="top"><a id="aba3852631c88f666e148008813c88979" name="aba3852631c88f666e148008813c88979"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>many_args_callback_handler</b> (<a class="el" href="group__type__system.html#gad1b3ed7bb2f9a2bf47df3299111ab74f">infix_context_t</a> *context, int a, double b, int c, const char *d, <a class="el" href="structPoint.html">Point</a> e, float f)</td></tr>
<tr class="memdesc:aba3852631c88f666e148008813c88979"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classA.html">A</a> callback handler that takes a mix of register and stack arguments. <br /></td></tr>
<tr class="separator:aba3852631c88f666e148008813c88979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bbfbfc732971dfdd40e6e8e1370150e" id="r_a5bbfbfc732971dfdd40e6e8e1370150e"><td class="memItemLeft" align="right" valign="top"><a id="a5bbfbfc732971dfdd40e6e8e1370150e" name="a5bbfbfc732971dfdd40e6e8e1370150e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>execute_many_args_callback</b> (int(*func_ptr)(int, double, int, const char *, <a class="el" href="structPoint.html">Point</a>, float))</td></tr>
<tr class="memdesc:a5bbfbfc732971dfdd40e6e8e1370150e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classA.html">A</a> harness to call the generated callback with many arguments. <br /></td></tr>
<tr class="separator:a5bbfbfc732971dfdd40e6e8e1370150e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c1d43081ae6d5c631b4c7bcfbdb25c" id="r_af4c1d43081ae6d5c631b4c7bcfbdb25c"><td class="memItemLeft" align="right" valign="top"><a id="af4c1d43081ae6d5c631b4c7bcfbdb25c" name="af4c1d43081ae6d5c631b4c7bcfbdb25c"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>subtest</b> (&quot;Forward calls with register and stack arguments&quot;)</td></tr>
<tr class="separator:af4c1d43081ae6d5c631b4c7bcfbdb25c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9a4d036a52ee68c2fc695ccb437ae55" id="r_aa9a4d036a52ee68c2fc695ccb437ae55"><td class="memItemLeft" align="right" valign="top"><a id="aa9a4d036a52ee68c2fc695ccb437ae55" name="aa9a4d036a52ee68c2fc695ccb437ae55"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>subtest</b> (&quot;Reverse call (callback) with stack arguments&quot;)</td></tr>
<tr class="separator:aa9a4d036a52ee68c2fc695ccb437ae55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a67c1cbb549407d754fe1894f74b40c3e" id="r_a67c1cbb549407d754fe1894f74b40c3e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67c1cbb549407d754fe1894f74b40c3e">TEST</a></td></tr>
<tr class="separator:a67c1cbb549407d754fe1894f74b40c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Tests FFI calls with a large number of arguments, forcing stack usage. </p>
<p>Copyright (c) 2025 Sanko Robinson</p>
<p>This source code is dual-licensed under the Artistic License 2.0 or the MIT License. You may choose to use this code under the terms of either license.</p>
<p>SPDX-License-Identifier: (Artistic-2.0 OR MIT)</p>
<p>The documentation blocks within this file are licensed under the Creative Commons Attribution 4.0 International License (CC BY 4.0).</p>
<p>SPDX-License-Identifier: CC-BY-4.0</p>
<p>This test suite is designed to stress-test the ABI implementation when the number of arguments exceeds the number of available parameter registers. It verifies correct stack layout, alignment, and argument marshalling for both forward and reverse FFI calls.</p>
<p>It covers several key scenarios:</p><ol type="1">
<li><b>Forward Call (Register Limit):</b> <a class="el" href="classA.html">A</a> function is called with the exact number of arguments to fill all available parameter registers, testing this important boundary condition.</li>
<li><b>Forward Call (One on Stack):</b> <a class="el" href="classA.html">A</a> function is called with one more argument than fits in registers, testing the transition to stack-based passing.</li>
<li><b>Forward Call (Massive Stack):</b> <a class="el" href="classA.html">A</a> function with over 500 arguments is called, verifying the library's ability to handle stack frames larger than a single memory page and exercising the bulk-copy optimization for homogeneous stack arguments.</li>
<li><b>Reverse Call (Callback):</b> <a class="el" href="classA.html">A</a> callback is created for a handler with a mixed set of arguments that will spill onto the stack, ensuring the JIT stub can correctly retrieve arguments from both registers and the caller's stack frame. </li>
</ol>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ac867de98a2635ed26a74d5dd3a5bd22e" name="ac867de98a2635ed26a74d5dd3a5bd22e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac867de98a2635ed26a74d5dd3a5bd22e">&#9670;&#160;</a></span>ARGS_0_TO_99</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ARGS_0_TO_99</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    LIST10(ARG, ), LIST10(ARG, 1), LIST10(ARG, 2), LIST10(ARG, 3), LIST10(ARG, 4), LIST10(ARG, 5), LIST10(ARG, 6), \</div>
<div class="line">        LIST10(ARG, 7), LIST10(ARG, 8), LIST10(ARG, 9)</div>
</div><!-- fragment -->
</div>
</div>
<a id="abe34be58e85259442d89c13a804cedda" name="abe34be58e85259442d89c13a804cedda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe34be58e85259442d89c13a804cedda">&#9670;&#160;</a></span>LIST100</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LIST100</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname">M, </span></td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname">p</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    LIST10(M, p##0), LIST10(M, p##1), LIST10(M, p##2), LIST10(M, p##3), LIST10(M, p##4), LIST10(M, p##5), \</div>
<div class="line">        LIST10(M, p##6), LIST10(M, p##7), LIST10(M, p##8), LIST10(M, p##9)</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a67c1cbb549407d754fe1894f74b40c3e" name="a67c1cbb549407d754fe1894f74b40c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67c1cbb549407d754fe1894f74b40c3e">&#9670;&#160;</a></span>TEST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{</div>
<div class="line">    plan(2)</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
