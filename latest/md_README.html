<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>infix FFI Library: &lt;tt&gt;infix&lt;/tt&gt;: A JIT-Powered FFI Library for C</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">infix FFI Library<span id="projectnumber">&#160;0.1.0</span>
   </div>
   <div id="projectbrief">A powerful and flexible Foreign Function Interface (FFI) library for C.</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">&lt;tt&gt;infix&lt;/tt&gt;: A JIT-Powered FFI Library for C</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md49"></a> <code>infix</code> is a modern, security-conscious Foreign Function Interface (FFI) library for C. It lets you call any C function—or create C callbacks—by describing them in a simple, human-readable string like <code>({int, *double}, *char) -&gt; int</code>.</p>
<p>At its core, <code>infix</code> is a Just-in-Time (JIT) compiler that generates tiny, highly-optimized machine code wrappers at runtime. These "trampolines" handle all the low-level details of the target platform's calling convention (ABI) behind a clean, uniform API, making <code>infix</code> a powerful tool for embedding scripting languages, building plugin systems, and simplifying complex C interoperability.</p>
<h1><a class="anchor" id="autotoc_md54"></a>
Key Features</h1>
<ul>
<li><b>Simple, Powerful APIs:</b> Use the high-level <b>Signature API</b> to create trampolines from a single string, or drop down to the memory-safe <b>Manual API</b> for dynamic, performance-critical use cases.</li>
<li><b>Powerful Introspection:</b> Parse signature strings to get detailed type information at runtime—including member names, offsets, pointer targets, and array sizes—ideal for dynamic data marshalling and building language bindings.</li>
<li><b>Secure by Design:</b> <code>infix</code> is hardened against vulnerabilities and validated through extensive fuzz testing:<ul>
<li><b>W^X Memory Protection:</b> JIT-compiled code is never writable and executable at the same time.</li>
<li><b>Guard Pages:</b> Freed trampolines are made inaccessible to prevent use-after-free bugs.</li>
<li><b>Read-Only Contexts:</b> Callback context data is made read-only to guard against runtime memory corruption.</li>
</ul>
</li>
<li><b>Stateful Callbacks Made Easy:</b> The reverse-call API is designed to make stateful callbacks simple and safe, even when the C library you're calling doesn't provide a <code>user_data</code> parameter.</li>
<li><b>Zero Dependencies &amp; Simple Integration:</b> <code>infix</code> uses a unity build, making integration into any C/C++ project trivial by simply compiling <code>src/infix.c</code>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md55"></a>
Who is this for?</h1>
<p><code>infix</code> is designed for developers who need to bridge the gap between different codebases or language runtimes. You'll find it especially useful if you are:</p>
<ul>
<li><b>A Language Binding Author:</b> <code>infix</code> is the ideal engine for allowing a high-level language like Python, Ruby, Perl, or Lua to call C libraries. The introspectable type system simplifies the complex task of data marshalling.</li>
<li><b>A Plugin System Architect:</b> Build a stable, ABI-agnostic plugin system. <code>infix</code> can provide the boundary layer, allowing you to load and call functions from shared libraries without tight coupling.</li>
<li><b>A C/C++ Developer:</b> Dynamically call functions from system libraries (<code>user32.dll</code>, <code>libc.so.6</code>, etc.) without needing to link against them at compile time.</li>
<li><b>A Security Researcher:</b> <code>infix</code> provides a powerful, fuzz-tested toolkit for analyzing and interacting with native code.</li>
</ul>
<h1><a class="anchor" id="autotoc_md56"></a>
Quick Start: The Two APIs</h1>
<p><code>infix</code> provides two APIs for creating trampolines. Most users should start with the Signature API.</p>
<h2><a class="anchor" id="autotoc_md57"></a>
1. The Signature API (Recommended)</h2>
<p>This is the easiest and safest way to use the library. You describe a function in a string, and <code>infix</code> handles the rest.</p>
<p><b>Example: Calling a Simple Function</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;infix/infix.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// The C function we want to call dynamically.</span></div>
<div class="line"><span class="keywordtype">int</span> add_ints(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b) {</div>
<div class="line">    <span class="keywordflow">return</span> a + b;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="comment">// 1. Describe the signature: int(int, int).</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* signature = <span class="stringliteral">&quot;(int32, int32) -&gt; int32&quot;</span>;</div>
<div class="line">    infix_forward_t* trampoline = NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 2. Generate the trampoline. This is a one-time setup cost.</span></div>
<div class="line">    infix_forward_create(&amp;trampoline, signature);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 3. Prepare arguments. The args array holds *pointers* to the values.</span></div>
<div class="line">    <span class="keywordtype">int</span> a = 40, b = 2;</div>
<div class="line">    <span class="keywordtype">void</span>* args[] = { &amp;a, &amp;b };</div>
<div class="line">    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 4. Get the callable function pointer and invoke it.</span></div>
<div class="line">    infix_cif_func cif_func = (infix_cif_func)infix_forward_get_code(trampoline);</div>
<div class="line">    cif_func((<span class="keywordtype">void</span>*)add_ints, &amp;result, args);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Result: %d\n&quot;</span>, result); <span class="comment">// Expected: 42</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 5. Clean up.</span></div>
<div class="line">    infix_forward_destroy(trampoline);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md58"></a>
Signature API Cheat Sheet</h3>
<blockquote class="doxtable">
<p>&zwj;For a complete guide, see the <b>Signature Language Reference</b>. </p>
</blockquote>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Concept   </th><th class="markdownTableHeadLeft">Syntax Example   </th><th class="markdownTableHeadLeft">C Equivalent    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Primitives</b>   </td><td class="markdownTableBodyLeft"><code>int</code>, <code>double</code>, <code>uint64</code>   </td><td class="markdownTableBodyLeft"><code>int</code>, <code>double</code>, <code>uint64_t</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Pointer</b>   </td><td class="markdownTableBodyLeft"><code>*char</code>   </td><td class="markdownTableBodyLeft"><code>char*</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Array</b>   </td><td class="markdownTableBodyLeft"><code>[16:int]</code>   </td><td class="markdownTableBodyLeft"><code>int arr[16]</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Struct</b>   </td><td class="markdownTableBodyLeft"><code>{int, double}</code>   </td><td class="markdownTableBodyLeft"><code>struct { int; double; }</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Union</b>   </td><td class="markdownTableBodyLeft"><code>&lt;int, double&gt;</code>   </td><td class="markdownTableBodyLeft"><code>union { int; double; }</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Packed Struct</b>   </td><td class="markdownTableBodyLeft"><code>!{char, int}</code>   </td><td class="markdownTableBodyLeft"><code>struct { char; int; } __attribute__((packed))</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Complex</b>   </td><td class="markdownTableBodyLeft"><code>c[double]</code>   </td><td class="markdownTableBodyLeft"><code>double _Complex</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>SIMD Vector</b>   </td><td class="markdownTableBodyLeft"><code>v[4:float]</code>   </td><td class="markdownTableBodyLeft"><code>__m128</code> (SSE)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"></td><td class="markdownTableBodyLeft"><code>v[4:double]</code>   </td><td class="markdownTableBodyLeft"><code>__m256d</code> (AVX)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Function Ptr</b>   </td><td class="markdownTableBodyLeft"><code>*((int) -&gt; void)</code>   </td><td class="markdownTableBodyLeft"><code>void (*func)(int)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Variadic</b>   </td><td class="markdownTableBodyLeft"><code>(*char; int)</code>   </td><td class="markdownTableBodyLeft"><code>const char*, int, ...</code>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md59"></a>
2. The Manual API (Advanced)</h2>
<p>For performance-critical or highly dynamic applications, you can build type descriptions manually. This API is <b>exclusively arena-based</b> to guarantee memory safety.</p>
<p><b>Example: Manually Describing a <code>Point</code> Struct</b></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;infix/infix.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{ <span class="keywordtype">double</span> x; <span class="keywordtype">double</span> y; } Point;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="comment">// 1. Create an arena. All type objects will be allocated from here.</span></div>
<div class="line">    infix_arena_t* arena = infix_arena_create(4096);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 2. Describe the members of the Point struct.</span></div>
<div class="line">    infix_struct_member members[] = {</div>
<div class="line">        infix_type_create_member(<span class="stringliteral">&quot;x&quot;</span>, infix_type_create_primitive(INFIX_PRIMITIVE_DOUBLE), offsetof(Point, x)),</div>
<div class="line">        infix_type_create_member(<span class="stringliteral">&quot;y&quot;</span>, infix_type_create_primitive(INFIX_PRIMITIVE_DOUBLE), offsetof(Point, y))</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 3. Create the struct type from the arena.</span></div>
<div class="line">    infix_type* point_type = NULL;</div>
<div class="line">    infix_type_create_struct(arena, &amp;point_type, members, 2);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now &#39;point_type&#39; can be used to generate a trampoline...</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 4. Destroy the arena to free the &#39;point_type&#39; and all other allocations.</span></div>
<div class="line">    <span class="comment">// Note: Once a trampoline is created with these types, it is safe to destroy</span></div>
<div class="line">    <span class="comment">// this arena. The trampoline handle now owns its own internal copy of all</span></div>
<div class="line">    <span class="comment">// necessary type information.</span></div>
<div class="line">    infix_arena_destroy(arena);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md60"></a>
Manual API Cheat Sheet</h3>
<details >
<summary >
<b>Click to expand the full Manual API reference</b></summary>
<p><b>Arena Management</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Function   </th><th class="markdownTableHeadLeft">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_arena_create(size)</code>   </td><td class="markdownTableBodyLeft">Create a memory arena for fast allocations.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_arena_alloc(arena, size, align)</code>   </td><td class="markdownTableBodyLeft">Allocate raw, uninitialized memory from the arena.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_arena_calloc(arena, n, size, align)</code>   </td><td class="markdownTableBodyLeft">Allocate zero-initialized memory from the arena.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_arena_destroy(arena)</code>   </td><td class="markdownTableBodyLeft">Free an arena and <b>all</b> objects allocated within it.   </td></tr>
</table>
<p><b>Type Creation</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Function   </th><th class="markdownTableHeadLeft">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_type_create_primitive(...)</code>   </td><td class="markdownTableBodyLeft">Get a static descriptor for <code>int</code>, <code>double</code>, etc.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_type_create_pointer()</code>   </td><td class="markdownTableBodyLeft">Get a static descriptor for a generic <code>void*</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_type_create_void()</code>   </td><td class="markdownTableBodyLeft">Get a static descriptor for <code>void</code> (for return types).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_type_create_struct(arena, ...)</code>   </td><td class="markdownTableBodyLeft">Build a struct type, calculating standard padding.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_type_create_packed_struct(arena, ...)</code>   </td><td class="markdownTableBodyLeft">Build a struct type with explicit size and alignment.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_type_create_union(arena, ...)</code>   </td><td class="markdownTableBodyLeft">Build a union type from its members.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_type_create_array(arena, ...)</code>   </td><td class="markdownTableBodyLeft">Build an array type.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_type_create_enum(arena, ...)</code>   </td><td class="markdownTableBodyLeft">Build an enum type from an underlying integer type.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_type_create_complex(arena, ...)</code>   </td><td class="markdownTableBodyLeft">Build a <code>_Complex</code> number type.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_type_create_pointer_to(arena, ...)</code>   </td><td class="markdownTableBodyLeft">Create a pointer type with introspection info.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_type_create_member(...)</code>   </td><td class="markdownTableBodyLeft">Helper to create a member for a struct or union.   </td></tr>
</table>
<p><b>Trampoline Management</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Function   </th><th class="markdownTableHeadLeft">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_forward_create_manual(...)</code>   </td><td class="markdownTableBodyLeft">Generate a forward trampoline from manual <code>infix_type</code> objects.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_forward_get_code(tramp)</code>   </td><td class="markdownTableBodyLeft">Get the callable <code>infix_cif_func</code> pointer from a forward trampoline.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_forward_destroy(tramp)</code>   </td><td class="markdownTableBodyLeft">Free a forward trampoline and its executable memory.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_reverse_create_manual(...)</code>   </td><td class="markdownTableBodyLeft">Generate a reverse trampoline (callback) from manual types.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_reverse_get_code(ctx)</code>   </td><td class="markdownTableBodyLeft">Get the native C function pointer from a callback context.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_reverse_get_user_data(ctx)</code>   </td><td class="markdownTableBodyLeft">Get the state pointer from within a callback handler.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_reverse_destroy(ctx)</code>   </td><td class="markdownTableBodyLeft">Free a reverse trampoline, its stub, and its context.   </td></tr>
</table>
<p><b>Type Introspection</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Function   </th><th class="markdownTableHeadLeft">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_type_get_category(type)</code>   </td><td class="markdownTableBodyLeft">Get the fundamental kind of a type (struct, pointer, etc.).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_type_get_size(type)</code>   </td><td class="markdownTableBodyLeft">Get the <code>sizeof</code> a type.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_type_get_alignment(type)</code>   </td><td class="markdownTableBodyLeft">Get the <code>_Alignof</code> a type.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>infix_type_get_member_count(type)</code>   </td><td class="markdownTableBodyLeft">Get the number of members in a struct or union.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>infix_type_get_member(type, index)</code>   </td><td class="markdownTableBodyLeft">Get a specific member's info (name, type, offset) by index.   </td></tr>
</table>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md61"></a>
Powerful Introspection for Dynamic Data Marshalling</h1>
<p>Beyond just calling functions, <code>infix</code> provides a powerful introspection API that allows you to parse a signature string and examine the complete memory layout of a C type at runtime. This is the key feature that makes <code>infix</code> an ideal engine for building language bindings, serializers, or any tool that needs to dynamically interact with C data structures.</p>
<p><b>Example: Inspecting a C Struct at Runtime</b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;infix/infix.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// The C struct we want to understand.</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    int32_t user_id;</div>
<div class="line">    <span class="keywordtype">double</span> score;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* name;</div>
<div class="line">} UserProfile;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="comment">// 1. A signature describing the C struct, with named fields.</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* profile_sig = <span class="stringliteral">&quot;{id:int32, score:double, name:*char}&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    infix_type* struct_type = NULL;</div>
<div class="line">    infix_arena_t* arena = NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 2. Parse the signature to get a detailed, introspectable type object.</span></div>
<div class="line">    <span class="keywordflow">if</span> (infix_type_from_signature(&amp;struct_type, &amp;arena, profile_sig) != INFIX_SUCCESS) {</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 3. Use the introspection API to query the layout.</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;Inspecting struct layout for: %s\n&quot;</span>, profile_sig);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Total size: %zu bytes, Alignment: %zu bytes\n&quot;</span>,</div>
<div class="line">           infix_type_get_size(struct_type),</div>
<div class="line">           infix_type_get_alignment(struct_type));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; infix_type_get_member_count(struct_type); ++i) {</div>
<div class="line">        <span class="keyword">const</span> infix_struct_member* member = infix_type_get_member(struct_type, i);</div>
<div class="line">        printf(<span class="stringliteral">&quot;  - Member &#39;%s&#39;: offset=%zu, size=%zu\n&quot;</span>,</div>
<div class="line">               member-&gt;name,</div>
<div class="line">               member-&gt;offset,</div>
<div class="line">               infix_type_get_size(member-&gt;type));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 4. Clean up the parser&#39;s temporary memory.</span></div>
<div class="line">    infix_arena_destroy(arena);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Output:</b> </p><div class="fragment"><div class="line">Inspecting struct layout for: {id:int32, score:double, name:*char}</div>
<div class="line">Total size: 24 bytes, Alignment: 8 bytes</div>
<div class="line">  - Member &#39;id&#39;: offset=0, size=4</div>
<div class="line">  - Member &#39;score&#39;: offset=8, size=8</div>
<div class="line">  - Member &#39;name&#39;: offset=16, size=8</div>
</div><!-- fragment --><p>This runtime layout information allows you to, for example, take a Perl hash and correctly pack its key/value pairs into a C <code>UserProfile</code> struct in memory, byte by byte.</p>
<h1><a class="anchor" id="autotoc_md62"></a>
Supported Platforms</h1>
<p><code>infix</code> is rigorously tested on a wide array of operating systems, compilers, and architectures with every commit.</p>
<details >
<summary >
<b>Click to view the full CI test matrix</b></summary>
<p></p>
<p></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">OS   </th><th class="markdownTableHeadLeft">Architecture   </th><th class="markdownTableHeadLeft">Compilers   </th><th class="markdownTableHeadLeft">Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Ubuntu (latest)   </td><td class="markdownTableBodyLeft">x86-64   </td><td class="markdownTableBodyLeft">GCC, Clang   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Ubuntu (latest)   </td><td class="markdownTableBodyLeft">AArch64   </td><td class="markdownTableBodyLeft">GCC, Clang   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Windows (latest)   </td><td class="markdownTableBodyLeft">x86-64   </td><td class="markdownTableBodyLeft">MSVC, Clang, GCC (MinGW)   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Windows (latest)   </td><td class="markdownTableBodyLeft">AArch64   </td><td class="markdownTableBodyLeft">MSVC, Clang   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">macOS (latest)   </td><td class="markdownTableBodyLeft">AArch64   </td><td class="markdownTableBodyLeft">Clang, GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">macOS (latest)   </td><td class="markdownTableBodyLeft">x86-64 (cross-compiled)   </td><td class="markdownTableBodyLeft">Clang, GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">FreeBSD (latest)   </td><td class="markdownTableBodyLeft">x86-64   </td><td class="markdownTableBodyLeft">Clang, GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">FreeBSD (latest)   </td><td class="markdownTableBodyLeft">AArch64   </td><td class="markdownTableBodyLeft">Clang, GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">OpenBSD (latest)   </td><td class="markdownTableBodyLeft">x86-64   </td><td class="markdownTableBodyLeft">Clang, GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">OpenBSD (latest)   </td><td class="markdownTableBodyLeft">AArch64   </td><td class="markdownTableBodyLeft">Clang, GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">NetBSD (latest)   </td><td class="markdownTableBodyLeft">x86-64   </td><td class="markdownTableBodyLeft">GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">NetBSD (latest)   </td><td class="markdownTableBodyLeft">AArch64   </td><td class="markdownTableBodyLeft">GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">DragonflyBSD (latest)   </td><td class="markdownTableBodyLeft">x86-64   </td><td class="markdownTableBodyLeft">GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Solaris (11.4)   </td><td class="markdownTableBodyLeft">x86-64   </td><td class="markdownTableBodyLeft">GCC   </td><td class="markdownTableBodyLeft">✅    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">OmniOS (stable)   </td><td class="markdownTableBodyLeft">x86-64   </td><td class="markdownTableBodyLeft">GCC   </td><td class="markdownTableBodyLeft">✅   </td></tr>
</table>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md63"></a>
Building and Integrating</h1>
<p>Full build instructions for <code>xmake</code>, <code>cmake</code>, GNU <code>make</code>, and other systems are available in <b><a class="el" href="md_INSTALL.html">INSTALL.md</a></b>.</p>
<p>Because <code>infix</code> uses a unity build, integration into an existing project is simple: add <code>src/infix.c</code> to your list of source files and add the <code>include/</code> directory to your include paths.</p>
<h1><a class="anchor" id="autotoc_md64"></a>
Learn More</h1>
<ul>
<li><b>Cookbook:</b> Practical, copy-pasteable recipes for common FFI tasks.</li>
<li><b>Signature Reference:</b> The complete guide to the signature mini-language.</li>
<li><b>Internals:</b> A deep dive into the library's architecture, JIT engine, and security features.</li>
<li><b>Porting Guide:</b> Instructions for adding support for new architectures.</li>
<li><b><a class="el" href="md_INSTALL.html">INSTALL.md</a>:</b> Detailed build and integration instructions.</li>
</ul>
<h1><a class="anchor" id="autotoc_md65"></a>
License &amp; Legal</h1>
<p><code>infix</code> is provided under multiple licenses to maximize its usability for all.</p>
<h2><a class="anchor" id="autotoc_md66"></a>
Code License</h2>
<p>Source code, including header files (<code>.h</code>) and implementation files (<code>.c</code>), is dual-licensed under the <b>Artistic License 2.0</b> or the <b>MIT License</b>. You may choose to use the code under the terms of either license.</p>
<p>See the [LICENSE-A2](LICENSE-A2) and/or [LICENSE-MIT](LICENSE-MIT) for the full text of both licenses.</p>
<h2><a class="anchor" id="autotoc_md67"></a>
Documentation License</h2>
<p>All standalone documentation (<code>.md</code>), explanatory text, Doxygen-style documentation blocks, comments, and code examples contained within this repository may be used, modified, and distributed under the terms of the <b>Creative Commons Attribution 4.0 International License (CC BY 4.0)</b>. I encourage you to share and adapt the documentation for any purpose (generating an API reference website, creating tutorials, etc.), as long as you give appropriate credit.</p>
<p>See the [LICENSE-CC](LICENSE-CC) for details. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
